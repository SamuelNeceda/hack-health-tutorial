import {Callout} from 'nextra-theme-docs'

# A04:2021 - Insecure Design

<Callout type="info" emoji="ℹ️">
For the information about **Insecure Design**, visit [page](https://owasp.org/Top10/A04_2021-Insecure_Design/)
</Callout>

# Generation of Error Message Containing Sensitive Information

<Callout type="warning" emoji="🔍">
  **CWE-209**: Generation of Error Message Containing Sensitive Information
</Callout>

## Demo
In the login screen of the web app, enter the valid username and invalid password. What message is displayed?

```
Invalid password.
```

Now, enter the invalid username and valid/invalid password. The message being displayed is:
```
Invalid username.
```

Both error messages indicate whether an user exists or not. Tt relates to a weakness in the authentication mechanism where an attacker can obtain information about the validity of the username or password by observing the system's response to invalid login attempts.
Therefore, it's essential to provide generic error messages to users when authentication fails to prevent such attacks.

## Prevention
In the source code, navigate to the file `jwtAuth.ts` and based on displayed error messages, change the error messages to generic ones.

## Sources
* https://owasp.org/Top10/A04_2021-Insecure_Design/